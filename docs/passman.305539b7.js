let e="6fe56dde-8e9b-45c5-96ee-7c8aea360a94",t="46017b0a-60bd-4d8d-9fd9-22d15de3ae0f",a=new class{bluetoothDevice=null;async init(){try{var a={optionalServices:[e,t,65173,7952],acceptAllDevices:!0};console.log(a),null!=this.bluetoothDevice&&this.bluetoothDevice.gatt.disconnect();let n=await navigator.bluetooth.requestDevice(a);this.bluetoothDevice=n,await this.connect()}catch(e){this.handleError(e)}}handleCharacteristicChange(e){console.warn("Characteristic value changed: ",new TextDecoder().decode(e.target.value))}async connect(){try{let a=await this.bluetoothDevice.gatt.connect();this.gattServer=a,this.service=await this.gattServer.getPrimaryService(e),this.characteristic=await this.service.getCharacteristic(t),await this.characteristic.startNotifications(),this.characteristic.addEventListener("characteristicvaluechanged",e=>{this.handleCharacteristicChange(e);let t=new TextDecoder("utf-8").decode(e.target.value);console.log("Characteristic value changed:",t);let a=t.split("\n");window.currentPwdServiceName.value=a[0],window.currentPwdLogin.value=a[1];let n=a[2],r=n.split("||")[0];window.currentPwdPasswordRuleMinLength.value="",window.currentPwdPasswordRuleMaxLength.value="",n.split("||")[1]&&(window.currentPwdPasswordRuleMinLength.value=n.split("||")[1].split("-")[0],window.currentPwdPasswordRuleMaxLength.value=n.split("||")[1].split("-")[1]),window.currentPwdPasswordRule.value=r,t.trim()?(document.body.classList.remove("show-create"),document.body.classList.add("show-update")):(document.body.classList.add("show-create"),document.body.classList.remove("show-update")),console.log(`Value as String: ${t}`)});let n=new TextEncoder().encode("request");this.characteristic.writeValueWithoutResponse(n)}catch(e){this.handleError(e)}}async submitUpdate(){let e=await this.service.getCharacteristic(t);console.log("Found the LED characteristic: ",e.uuid);let a=window.currentPwdServiceName.value||"rnd1";if(window.currentPwdPasswordRuleMinLength.value||window.currentPwdPasswordRuleMaxLength.value){if(!window.currentPwdPasswordRuleMinLength.value||!window.currentPwdPasswordRuleMaxLength.value)return void alert("wrong pwd rule range");a+="||"+window.currentPwdPasswordRuleMinLength.value+"-"+window.currentPwdPasswordRuleMaxLength.value}let n=new TextEncoder().encode("update\n"+window.currentPwdServiceName.value+"\n"+window.currentPwdLogin.value+"\n"+a);e.writeValueWithoutResponse(n)}async submit(){let e=await this.service.getCharacteristic(t);console.log("Found the LED characteristic: ",e.uuid);let a=window.pwdPasswordRule.value||"rnd1";if(window.pwdPasswordRuleMinLength.value||window.pwdPasswordRuleMaxLength.value){if(!window.pwdPasswordRuleMinLength.value||!window.pwdPasswordRuleMaxLength.value)return void alert("wrong pwd rule range");a+="||"+window.pwdPasswordRuleMinLength.value+"-"+window.pwdPasswordRuleMaxLength.value}let n=new TextEncoder().encode("create\n"+window.pwdServiceName.value+"\n"+window.pwdLogin.value+"\n"+a+"\n"+window.pwdPassword.value);e.writeValueWithoutResponse(n),window.pwdServiceName.value="",window.pwdLogin.value="",window.pwdPassword.value="",window.pwdPasswordRule.value="",window.pwdPasswordRuleMinLength.value="",window.pwdPasswordRuleMaxLength.value=""}async deleteItem(){let e=window.currentPwdPasswordRule.value||"rnd1";if(window.currentPwdPasswordRuleMinLength.value||window.currentPwdPasswordRuleMaxLength.value){if(!window.currentPwdPasswordRuleMinLength.value||!window.currentPwdPasswordRuleMaxLength.value)return void alert("wrong pwd rule range");e+="||"+window.currentPwdPasswordRuleMinLength.value+"-"+window.currentPwdPasswordRuleMaxLength.value}console.warn("remove_"+(window.currentPwdServiceName.value+"\n"+window.currentPwdLogin.value)+"\n"+e);let t=new TextEncoder().encode("remove_"+(window.currentPwdServiceName.value+"\n"+window.currentPwdLogin.value)+"\n"+e);this.characteristic.writeValueWithoutResponse(t)}handleError(e){console.error(e)}};window.pwdStart.addEventListener("click",()=>{a.init()},!1),window.tabCreate.addEventListener("click",()=>{document.body.classList.add("show-create"),document.body.classList.remove("show-update")},!1),window.tabUpdate.addEventListener("click",()=>{document.body.classList.remove("show-create"),document.body.classList.add("show-update")},!1);let n=Date.now();window.createForm.addEventListener("submit",e=>{e.preventDefault(),Date.now()>n+3e3&&a.submit(),n=Date.now()}),window.updateForm.addEventListener("submit",e=>{e.preventDefault(),Date.now()>n+3e3&&a.submit(),n=Date.now()}),window.pwdDelete.addEventListener("click",e=>{e.preventDefault(),confirm("Are you sure to delete the item?")&&setTimeout(()=>{a.deleteItem()},1e3)});
//# sourceMappingURL=passman.305539b7.js.map
